---
## Front matter
lang: ru-RU
title: "Лабораторная работа №4" 
subtitle: "Базовая настройка HTTP-сервера Apache"
author:
  - Андреева С.В.
institute:
  - Группа НПИбд-01-23
  - Российский университет дружбы народов, Москва, Россия

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'

## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Андреева Софья Владимировна
  * Группа НПИбд-01-23
  * Российский университет дружбы народов


:::
::: {.column width="30%"}


:::
::::::::::::::

# Вводная часть

## Цель работы

Приобретение практических навыков по установке и базовому конфигурированию HTTP-сервера Apache.

## Установка HTTP-сервера

Загрузим нашу операционную систему и перейдем в рабочий каталог с проектом:
```
cd /var/tmp/svandreeva/vagran
```
Затем запустим виртуальную машину server:
```
make server-up
```

На виртуальной машине server войдем под созданным в предыдущей работе
пользователем и откроем терминал. Перейдем в режим суперпользователя и установим стандартный веб-сервер:

## Установка HTTP-сервера

![Установка стандартного веб-сервера](image/1.png){#fig:001 width=70%}

## Базовое конфигурирование HTTP-сервера

Просмотрим содержание конфигурационных файлов в каталогах /etc/httpd/conf и /etc/httpd/conf.d.

## Выполнение работы

![conf ](image/1(1).png){#fig:017 width=70%}

## Выполнение работы

![conf.d ](image/1(2).png){#fig:018 width=70%}

## Выполнение работы

Внесем изменения в настройки межсетевого экрана узла server, разрешив работу с http:

![Разрешение работы с http](image/2.png){#fig:002 width=70%}

## Выполнение работы

В дополнительном терминале запустим в режиме реального времени расширенный лог системных сообщений, чтобы проверить корректность работы системы(рис. @fig:003):

![Запуск лога системных сообщений](image/3.png){#fig:003 width=60%}

## Выполнение работы

В первом терминале активируем и запустим HTTP-сервер следующими командами:

```
systemctl enable httpd
systemctl start httpd
```

Просмотрим расширенный лог системных сообщений, чтобы убедиться, что веб-сервер успешно запустился:

## Выполнение работы

![Запуск веб-сервера](image/4.png){#fig:004 width=70%}

## Анализ работы HTTP-сервера

Запустим виртуальную машину client:
```
make client-up
```
На виртуальной машине server просмотрим лог ошибок работы веб-сервера и запустим мониторинг доступа к веб-серверу.

Затем виртуальной машине client запустим браузер и в адресной строке введите 192.168.1.1.

## Выполнение работы

![Тестовая страница веб-сервера](image/5.png){#fig:005 width=70%}

## Выполнение работы

Посмотрим информацию, отразившуюся при мониторинге:

![Лог ошибок](image/6.png){#fig:006 width=70%}

## Выполнение работы

![Информация мониторинга](image/7.png){#fig:007 width=70%}

Можно увидеть ip-адрес устройства, зашедшего на веб-сервер, дату доступа, версию браузера, информацию об устройстве(его ОС и архитектура).

## Настройка виртуального хостинга для HTTP-сервера

Остановим работу DNS-сервера для внесения изменений в файлы описания DNS-зон
Добавим запись для HTTP-сервера в конце файла прямой DNS-зоны /var/named/master/fz/svandreeva.net
и в конце файла обратной зоны /var/named/master/rz/192.168.1
Также удалим из этих каталогов файлы журналов DNS: user.net.jnl и 192.168.1.jnl.

Затем перезапустим DNS-сервер

В каталоге /etc/httpd/conf.d создадим файлы server.svandreeva.net.conf и www.svandreeva.net.conf 

## Выполнение работы

Откроем на редактирование файл server.svandreeva.net.conf и внесем следующее содержание:

![Внесение содержания файла server.svandreeva.net.conf](image/8.png){#fig:008 width=60%}

## Выполнение работы

Откроем на редактирование файл www.svandreeva.net.conf и внесем следующее содержание:

![Внесение содержания файла www.svandreeva.net.conf](image/9.png){#fig:009 width=60%}

## Выполнение работы

Перейдем в каталог /var/www/html, в котором должны находиться файлы с содержимым (контентом) веб-серверов, и создадим тестовые страницы для виртуальных веб-серверов server.svandreeva.net и www.svandreeva.net. Для виртуального веб-сервера server.svandreeva.net:
```
cd /var/www/html
mkdir server.svandreeva.net
cd /var/www/html/server.svandreeva.net
touch index.htm
```
## Выполнение работы

Откроем на редактирование файл index.html и внесем следующее содержание :

![Внесение содержания файла index.html для server.svandreeva.net](image/10.png){#fig:010 width=60%}

## Выполнение работы

Для виртуального веб-сервера www.svandreeva.net:
```
cd /var/www/html
mkdir www.svandreeva.net
cd /var/www/html/www.svandreeva.net
touch index.htm
```
## Выполнение работы

Откроем на редактирование файл index.html и внесем следующее содержание :

![Внесение содержания файла index.html для www.svandreeva.net](image/11.png){#fig:011 width=70%}

## Выполнение работы

Теперь скопируем права доступа в каталог с веб-контентом командой:
```
chown -R apache:apache /var/www
```
Затем восстановим контекст безопасности:
```
restorecon -vR /etc
restorecon -vR /var/named
restorecon -vR /var/www
```
И тперь перезапустим HTTP-сервер.

## Выполнение работы

На виртуальной машине client убедимся в корректном доступе к веб-серверу по адресам server.svandreeva.net и www.svandreeva.net в адресной строке веб-браузера:

![server.svandreeva.net](image/12.png){#fig:012 width=50%}

## Выполнение работы

![www.svandreeva.net](image/13.png){#fig:013 width=70%}

## Внесение изменений в настройки внутреннего окружения виртуальной машины

На виртуальной машине server перейдем в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/server/, создадим в нём каталог http, в который поместим в соответствующие подкаталоги конфигурационные файлы HTTP-сервера, затем заменим конфигурационные файлы DNS-сервера и в каталоге /vagrant/provision/server создадим исполняемый файл http.sh

![Создание окружения для внесения изменений в настройки окружающей среды](image/14.png){#fig:014 width=60%}

## Выполнение работы

Открыв http.sh на редактирование, пропишем в нём следующий скрипт:

![Содержание http.sh](image/15.png){#fig:015 width=60%}

## Выполнение работы

Для отработки созданного скрипта во время загрузки виртуальной машины server в конфигурационном файле Vagrantfile добавим в разделе конфигурации для сервера(@fig:016):

![Изменение файла Vagrantfile](image/16.png){#fig:016 width=50%}

# Выводы

В результате выполнения данной работы были приобретены практические навыки по установке и базовому конфигурированию HTTP-сервера Apache.
